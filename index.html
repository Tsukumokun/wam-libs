<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <title>WAM-LIBS</title>
    <link rel="stylesheet" href="index.css" />
    <script src="http://code.jquery.com/jquery-git2.js"></script>
    <script src="jq/jquery.accordion.js"></script>
</head>
<body class="font-helvetica font-light color-flat-black">
    <div class="ribbon">
        <a href="https://github.com/Tsukumokun/wam-libs">Fork me on GitHub</a>
    </div>
    <div class="wam">
        <span class="compiled">Compiled</span><br/>
        <span class="with">with</span><br/>
        <span class="WAM">WAM</span>
    </div>
    <section id="header">
        <img id="logo" src="res/logo.png" />
        <header class="font-bold">WAM-LIBS<article id="beta" class="font-normal">Beta</article></header>

        <article id="description" class="color-flat-gray font-semi-bold">Free Web Asset Manager</article>
        <article id="credit" class="color-flat-gray font-semi-bold">Minification powered by <a href="http://yui.github.io/yuicompressor/">yui-compressor</a></article>
    </section>

    <a href="http://tsukumokun.github.io/web-asset-manager/" id="wammain">
        <span id="arrow">&gt;</span>
        WAM
    </a>

    <section id="files">
        <ul id="jswrapper">
           <li>
               <a href="#js" class="title">JS</a>
               <ul id="jsfiles">

               </ul>
           </li>
        </ul>
        <ul id="csswrapper">
           <li>
               <a href="#css" class="title">CSS</a>
               <ul id="cssfiles">

               </ul>
           </li>
        </ul>
    </section>
    
    <script>

function counts(){
    this.cnt = 1;
}

function getdata(from,to,count,done){
    $.ajax({
        url:from,
        success:function(data)
        {
            data.forEach(function(item){
                if(item["type"]=="dir")
                {
                    $(to).append("<li><a class='title' href='#"+item["name"]+"'>"+item["name"]+"</a><ul id="+item["sha"]+"></ul></li>")
                    getdata(from+"/"+item["name"],"#"+item["sha"],count,done)
                    count.cnt++;
                }
                else
                {
                    var href = item["html_url"]
                                    .replace("/blob","")
                                    .replace("://","://raw.")

                    $(to).append('<li><a href="'+href+'" download><img src="res/download.png">'+item["name"]+'</a></li>')
                }
            })
            count.cnt--;
            console.log(from+count.cnt);
            if(count.cnt==0)
                setTimeout(done,500)
        }
    })
}
var jscnt = new counts()
var csscnt = new counts()
getdata("https://api.github.com/repos/Tsukumokun/wam-libs/contents/js","#jsfiles",jscnt,function(){$("#jswrapper").accordion()})
getdata("https://api.github.com/repos/Tsukumokun/wam-libs/contents/css","#cssfiles",csscnt,function(){$("#csswrapper").accordion()})
        
    </script>
</html>